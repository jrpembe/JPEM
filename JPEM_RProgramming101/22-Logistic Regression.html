<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jason Pemberton">

<title>Logistic Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="22-Logistic Regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="22-Logistic Regression_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="22-Logistic Regression_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="22-Logistic Regression_files/libs/quarto-html/popper.min.js"></script>
<script src="22-Logistic Regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="22-Logistic Regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="22-Logistic Regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="22-Logistic Regression_files/libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="22-Logistic Regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="22-Logistic Regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="22-Logistic Regression_files/libs/bootstrap/bootstrap-0d2dcb580ab50e29fb07dd4b1ec3ce1f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<link href="22-Logistic Regression_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="22-Logistic Regression_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="22-Logistic Regression_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="22-Logistic Regression_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="22-Logistic Regression_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="22-Logistic Regression_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="22-Logistic Regression_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="22-Logistic Regression_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="22-Logistic Regression_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-logistic-regression" id="toc-what-is-logistic-regression" class="nav-link active" data-scroll-target="#what-is-logistic-regression">What is Logistic Regression?</a></li>
  <li><a href="#a-single-numeric-predictor" id="toc-a-single-numeric-predictor" class="nav-link" data-scroll-target="#a-single-numeric-predictor">A Single Numeric Predictor</a></li>
  <li><a href="#creating-a-simple-model" id="toc-creating-a-simple-model" class="nav-link" data-scroll-target="#creating-a-simple-model">Creating a simple model</a>
  <ul class="collapse">
  <li><a href="#explanatory-notes" id="toc-explanatory-notes" class="nav-link" data-scroll-target="#explanatory-notes">Explanatory Notes</a></li>
  </ul></li>
  <li><a href="#a-single-categorical-predictor" id="toc-a-single-categorical-predictor" class="nav-link" data-scroll-target="#a-single-categorical-predictor">A Single Categorical Predictor</a></li>
  <li><a href="#adding-variables" id="toc-adding-variables" class="nav-link" data-scroll-target="#adding-variables">Adding Variables</a></li>
  <li><a href="#confounding-variables" id="toc-confounding-variables" class="nav-link" data-scroll-target="#confounding-variables">Confounding Variables</a></li>
  <li><a href="#effect-modifiers" id="toc-effect-modifiers" class="nav-link" data-scroll-target="#effect-modifiers">Effect Modifiers</a></li>
  <li><a href="#collinearity" id="toc-collinearity" class="nav-link" data-scroll-target="#collinearity">Collinearity</a></li>
  <li><a href="#building-the-model" id="toc-building-the-model" class="nav-link" data-scroll-target="#building-the-model">Building the Model</a></li>
  <li><a href="#checking-model-assumptions" id="toc-checking-model-assumptions" class="nav-link" data-scroll-target="#checking-model-assumptions">Checking Model Assumptions</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Logistic Regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jason Pemberton </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="what-is-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="what-is-logistic-regression">What is Logistic Regression?</h2>
<div class="callout.red-bg">
<p>Logistic regression is a statistical method used to model and analyze datasets where the outcome variable is binary (e.g.&nbsp;“yes/no”, or “male/female”) and predictor variables are those believed to either influence, predict, or explain the outcome.</p>
</div>
<p>The best way to learn logistic regression is to look at an example (and try to replicate the analysis yourself). Use R to analyze a dataset called PimaIndiansDiabetes (accessed by installing mlbench).</p>
<p>The dataset has:</p>
<p><strong>A binary outcome variable:</strong></p>
<ul>
<li>diabetes (positive or negative)</li>
</ul>
<p><strong>Predictor variables:</strong></p>
<ul>
<li><p>pregnant, number of times pregnant</p></li>
<li><p>glucose, blood glucose levels</p></li>
<li><p>pressure, diastolic blood pressure</p></li>
<li><p>triceps, triceps skin fold thickness</p></li>
<li><p>insulin, blood insulin levels</p></li>
<li><p>mass, body mass index (BMI)</p></li>
<li><p>pedigree, diabetes pedigree function</p></li>
<li><p>age, age in years</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Objective: To determine which predictor variables are associated with meaningful changes in the probability of being diagnosed with diabetes and to quantify the extent of their influences.</p>
</div>
</div>
<p>Understand how predictors influence the probability of diabetes can inform risk stratification, policy, or clinical interventions.</p>
<p>Here is a snapshot of the first ten rows of data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PimaIndiansDiabetes"</span>)</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare and display the table</span></span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>PimaIndiansDiabetes <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pregnant, glucose, pressure, triceps, insulin, mass, pedigree, age, diabetes) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diabetes =</span> <span class="fu">ifelse</span>(diabetes <span class="sc">==</span> <span class="st">"pos"</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span>  <span class="co"># showing just a sample for clarity</span></span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"PimaIndiansDiabetes Dataset"</span>) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>)),</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> diabetes,</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> diabetes <span class="sc">==</span> <span class="st">"Positive"</span></span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"mistyrose"</span>)),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-19" class="code-annotation-target"><a href="#annotated-cell-1-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="annotated-cell-1-20"><a href="#annotated-cell-1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-21"><a href="#annotated-cell-1-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> diabetes,</span>
<span id="annotated-cell-1-22"><a href="#annotated-cell-1-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> diabetes <span class="sc">==</span> <span class="st">"Negative"</span></span>
<span id="annotated-cell-1-23"><a href="#annotated-cell-1-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-1-24"><a href="#annotated-cell-1-24" aria-hidden="true" tabindex="-1"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">This is a comment</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="19" data-code-annotation="2">This is another comment</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="ojcaefbpul" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ojcaefbpul table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ojcaefbpul thead, #ojcaefbpul tbody, #ojcaefbpul tfoot, #ojcaefbpul tr, #ojcaefbpul td, #ojcaefbpul th {
  border-style: none;
}

#ojcaefbpul p {
  margin: 0;
  padding: 0;
}

#ojcaefbpul .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ojcaefbpul .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ojcaefbpul .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ojcaefbpul .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ojcaefbpul .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojcaefbpul .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojcaefbpul .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojcaefbpul .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ojcaefbpul .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ojcaefbpul .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ojcaefbpul .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ojcaefbpul .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ojcaefbpul .gt_spanner_row {
  border-bottom-style: hidden;
}

#ojcaefbpul .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ojcaefbpul .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ojcaefbpul .gt_from_md > :first-child {
  margin-top: 0;
}

#ojcaefbpul .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ojcaefbpul .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ojcaefbpul .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ojcaefbpul .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ojcaefbpul .gt_row_group_first td {
  border-top-width: 2px;
}

#ojcaefbpul .gt_row_group_first th {
  border-top-width: 2px;
}

#ojcaefbpul .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojcaefbpul .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ojcaefbpul .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ojcaefbpul .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojcaefbpul .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojcaefbpul .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ojcaefbpul .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ojcaefbpul .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ojcaefbpul .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojcaefbpul .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojcaefbpul .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojcaefbpul .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojcaefbpul .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojcaefbpul .gt_left {
  text-align: left;
}

#ojcaefbpul .gt_center {
  text-align: center;
}

#ojcaefbpul .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ojcaefbpul .gt_font_normal {
  font-weight: normal;
}

#ojcaefbpul .gt_font_bold {
  font-weight: bold;
}

#ojcaefbpul .gt_font_italic {
  font-style: italic;
}

#ojcaefbpul .gt_super {
  font-size: 65%;
}

#ojcaefbpul .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ojcaefbpul .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ojcaefbpul .gt_indent_1 {
  text-indent: 5px;
}

#ojcaefbpul .gt_indent_2 {
  text-indent: 10px;
}

#ojcaefbpul .gt_indent_3 {
  text-indent: 15px;
}

#ojcaefbpul .gt_indent_4 {
  text-indent: 20px;
}

#ojcaefbpul .gt_indent_5 {
  text-indent: 25px;
}

#ojcaefbpul .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ojcaefbpul div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border">PimaIndiansDiabetes Dataset</th>
</tr>
<tr class="gt_col_headings even">
<th id="pregnant" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pregnant</th>
<th id="glucose" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">glucose</th>
<th id="pressure" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pressure</th>
<th id="triceps" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">triceps</th>
<th id="insulin" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">insulin</th>
<th id="mass" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mass</th>
<th id="pedigree" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pedigree</th>
<th id="age" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">age</th>
<th id="diabetes" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">diabetes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="pregnant">6</td>
<td class="gt_row gt_right" headers="glucose">148</td>
<td class="gt_row gt_right" headers="pressure">72</td>
<td class="gt_row gt_right" headers="triceps">35</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">33.6</td>
<td class="gt_row gt_right" headers="pedigree">0.627</td>
<td class="gt_row gt_right" headers="age">50</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="pregnant">1</td>
<td class="gt_row gt_right" headers="glucose">85</td>
<td class="gt_row gt_right" headers="pressure">66</td>
<td class="gt_row gt_right" headers="triceps">29</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">26.6</td>
<td class="gt_row gt_right" headers="pedigree">0.351</td>
<td class="gt_row gt_right" headers="age">31</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #FFE4E1">Negative</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="pregnant">8</td>
<td class="gt_row gt_right" headers="glucose">183</td>
<td class="gt_row gt_right" headers="pressure">64</td>
<td class="gt_row gt_right" headers="triceps">0</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">23.3</td>
<td class="gt_row gt_right" headers="pedigree">0.672</td>
<td class="gt_row gt_right" headers="age">32</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="pregnant">1</td>
<td class="gt_row gt_right" headers="glucose">89</td>
<td class="gt_row gt_right" headers="pressure">66</td>
<td class="gt_row gt_right" headers="triceps">23</td>
<td class="gt_row gt_right" headers="insulin">94</td>
<td class="gt_row gt_right" headers="mass">28.1</td>
<td class="gt_row gt_right" headers="pedigree">0.167</td>
<td class="gt_row gt_right" headers="age">21</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #FFE4E1">Negative</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="pregnant">0</td>
<td class="gt_row gt_right" headers="glucose">137</td>
<td class="gt_row gt_right" headers="pressure">40</td>
<td class="gt_row gt_right" headers="triceps">35</td>
<td class="gt_row gt_right" headers="insulin">168</td>
<td class="gt_row gt_right" headers="mass">43.1</td>
<td class="gt_row gt_right" headers="pedigree">2.288</td>
<td class="gt_row gt_right" headers="age">33</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="pregnant">5</td>
<td class="gt_row gt_right" headers="glucose">116</td>
<td class="gt_row gt_right" headers="pressure">74</td>
<td class="gt_row gt_right" headers="triceps">0</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">25.6</td>
<td class="gt_row gt_right" headers="pedigree">0.201</td>
<td class="gt_row gt_right" headers="age">30</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #FFE4E1">Negative</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="pregnant">3</td>
<td class="gt_row gt_right" headers="glucose">78</td>
<td class="gt_row gt_right" headers="pressure">50</td>
<td class="gt_row gt_right" headers="triceps">32</td>
<td class="gt_row gt_right" headers="insulin">88</td>
<td class="gt_row gt_right" headers="mass">31.0</td>
<td class="gt_row gt_right" headers="pedigree">0.248</td>
<td class="gt_row gt_right" headers="age">26</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="pregnant">10</td>
<td class="gt_row gt_right" headers="glucose">115</td>
<td class="gt_row gt_right" headers="pressure">0</td>
<td class="gt_row gt_right" headers="triceps">0</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">35.3</td>
<td class="gt_row gt_right" headers="pedigree">0.134</td>
<td class="gt_row gt_right" headers="age">29</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #FFE4E1">Negative</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="pregnant">2</td>
<td class="gt_row gt_right" headers="glucose">197</td>
<td class="gt_row gt_right" headers="pressure">70</td>
<td class="gt_row gt_right" headers="triceps">45</td>
<td class="gt_row gt_right" headers="insulin">543</td>
<td class="gt_row gt_right" headers="mass">30.5</td>
<td class="gt_row gt_right" headers="pedigree">0.158</td>
<td class="gt_row gt_right" headers="age">53</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="pregnant">8</td>
<td class="gt_row gt_right" headers="glucose">125</td>
<td class="gt_row gt_right" headers="pressure">96</td>
<td class="gt_row gt_right" headers="triceps">0</td>
<td class="gt_row gt_right" headers="insulin">0</td>
<td class="gt_row gt_right" headers="mass">0.0</td>
<td class="gt_row gt_right" headers="pedigree">0.232</td>
<td class="gt_row gt_right" headers="age">54</td>
<td class="gt_row gt_left" headers="diabetes" style="background-color: #90EE90">Positive</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="a-single-numeric-predictor" class="level2">
<h2 class="anchored" data-anchor-id="a-single-numeric-predictor">A Single Numeric Predictor</h2>
<p>Let’s start with a single numeric predictor. In this case “glucose” and take look at the relationship between changing levels of glucose and the likelihood of being diagnosed with diabetes. <a href="#fig-scatter-plot" class="quarto-xref">Figure&nbsp;1</a> shows the diagnostic status for each value in the dataset of glucose. It is clear that for lower levels of glucose, fewer people are diagnosed with diabetes and for higher levels of glucose, more people are diagnosed with diabetes.</p>
<p>Logistic regression uses that data to create a model than can be used to predict the probability of being diagnosed with diabetes at any level of glucose. <a href="#fig-logistic-regression" class="quarto-xref">Figure&nbsp;2</a> shows how that probability changes over the values of glucose levels.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Distribution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Probability</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>PimaIndiansDiabetes <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> glucose, <span class="at">y =</span> <span class="fu">as.numeric</span>(diabetes <span class="sc">==</span> <span class="st">"pos"</span>) <span class="sc">*</span> <span class="fl">0.5</span>, <span class="at">color =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"neg"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, <span class="st">"pos"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glucose Levels and Diabetes Status"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Glucose Levels"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No Diabetes"</span>, <span class="st">"Diabetes"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="22-Logistic-Regression_files/figure-html/fig-scatter-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Glucose Levels and Diabetes Status
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> glucose, <span class="at">data =</span> PimaIndiansDiabetes, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for the curve</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>glucose_range <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">glucose =</span> <span class="fu">seq</span>(<span class="fu">min</span>(PimaIndiansDiabetes<span class="sc">$</span>glucose),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">max</span>(PimaIndiansDiabetes<span class="sc">$</span>glucose),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">length.out =</span> <span class="dv">500</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>glucose_range<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> glucose_range, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predicted probability</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> glucose_range,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>glucose,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>prob,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Probability Curve"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Diabetes by Glucose Level"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Glucose Level"</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Probability of Diabetes"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-logistic-regression" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f7c075ad91428cabaed5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f7c075ad91428cabaed5">{"x":{"visdat":{"83dc731f689c":["function () ","plotlyVisDat"]},"cur_data":"83dc731f689c","attrs":{"83dc731f689c":{"x":{},"y":{},"mode":"lines","name":"Probability Curve","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Probability of Diabetes by Glucose Level","xaxis":{"domain":[0,1],"automargin":true,"title":"Glucose Level"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability of Diabetes"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,0.39879759519038077,0.79759519038076154,1.1963927855711423,1.5951903807615231,1.9939879759519039,2.3927855711422845,2.7915831663326656,3.1903807615230462,3.5891783567134268,3.9879759519038078,4.3867735470941884,4.785571142284569,5.1843687374749496,5.5831663326653311,5.9819639278557117,6.3807615230460923,6.7795591182364729,7.1783567134268536,7.577154308617235,7.9759519038076157,8.3747494989979963,8.7735470941883769,9.1723446893787575,9.5711422845691381,9.9699398797595187,10.368737474949899,10.767535070140282,11.166332665330662,11.565130260521043,11.963927855711423,12.362725450901804,12.761523046092185,13.160320641282565,13.559118236472946,13.957915831663327,14.356713426853707,14.755511022044088,15.15430861723447,15.553106212424851,15.951903807615231,16.350701402805612,16.749498997995993,17.148296593186373,17.547094188376754,17.945891783567134,18.344689378757515,18.743486973947896,19.142284569138276,19.541082164328657,19.939879759519037,20.338677354709418,20.737474949899799,21.136272545090179,21.535070140280563,21.933867735470944,22.332665330661325,22.731462925851705,23.130260521042086,23.529058116232466,23.927855711422847,24.326653306613228,24.725450901803608,25.124248496993989,25.523046092184369,25.92184368737475,26.320641282565131,26.719438877755511,27.118236472945892,27.517034068136272,27.915831663326653,28.314629258517034,28.713426853707414,29.112224448897795,29.511022044088175,29.90981963927856,30.30861723446894,30.707414829659321,31.106212424849701,31.505010020040082,31.903807615230463,32.302605210420843,32.701402805611224,33.100200400801604,33.498997995991985,33.897795591182366,34.296593186372746,34.695390781563127,35.094188376753507,35.492985971943888,35.891783567134269,36.290581162324649,36.68937875751503,37.08817635270541,37.486973947895791,37.885771543086172,38.284569138276552,38.683366733466933,39.082164328657313,39.480961923847694,39.879759519038075,40.278557114228455,40.677354709418836,41.076152304609217,41.474949899799597,41.873747494989978,42.272545090180358,42.671342685370746,43.070140280561127,43.468937875751507,43.867735470941888,44.266533066132268,44.665330661322649,45.06412825651303,45.46292585170341,45.861723446893791,46.260521042084171,46.659318637274552,47.058116232464933,47.456913827655313,47.855711422845694,48.254509018036075,48.653306613226455,49.052104208416836,49.450901803607216,49.849699398797597,50.248496993987978,50.647294589178358,51.046092184368739,51.444889779559119,51.8436873747495,52.242484969939881,52.641282565130261,53.040080160320642,53.438877755511022,53.837675350701403,54.236472945891784,54.635270541082164,55.034068136272545,55.432865731462925,55.831663326653306,56.230460921843687,56.629258517034067,57.028056112224448,57.426853707414828,57.825651302605209,58.22444889779559,58.62324649298597,59.022044088176351,59.420841683366731,59.819639278557119,60.2184368737475,60.61723446893788,61.016032064128261,61.414829659318642,61.813627254509022,62.212424849699403,62.611222444889783,63.010020040080164,63.408817635270545,63.807615230460925,64.206412825651299,64.605210420841686,65.00400801603206,65.402805611222448,65.801603206412821,66.200400801603209,66.599198396793582,66.99799599198397,67.396793587174344,67.795591182364731,68.194388777555119,68.593186372745492,68.99198396793588,69.390781563126254,69.789579158316641,70.188376753507015,70.587174348697403,70.985971943887776,71.384769539078164,71.783567134268537,72.182364729458925,72.581162324649299,72.979959919839686,73.37875751503006,73.777555110220447,74.176352705410821,74.575150300601209,74.973947895791582,75.37274549098197,75.771543086172343,76.170340681362731,76.569138276553105,76.967935871743492,77.366733466933866,77.765531062124253,78.164328657314627,78.563126252505015,78.961923847695388,79.360721442885776,79.759519038076149,80.158316633266537,80.557114228456911,80.955911823647298,81.354709418837672,81.75350701402806,82.152304609218433,82.551102204408821,82.949899799599194,83.348697394789582,83.747494989979955,84.146292585170343,84.545090180360717,84.943887775551104,85.342685370741492,85.741482965931866,86.140280561122253,86.539078156312627,86.937875751503014,87.336673346693388,87.735470941883776,88.134268537074149,88.533066132264537,88.93186372745491,89.330661322645298,89.729458917835672,90.128256513026059,90.527054108216433,90.925851703406821,91.324649298597194,91.723446893787582,92.122244488977955,92.521042084168343,92.919839679358716,93.318637274549104,93.717434869739478,94.116232464929865,94.515030060120239,94.913827655310627,95.312625250501,95.711422845691388,96.110220440881761,96.509018036072149,96.907815631262523,97.30661322645291,97.705410821643284,98.104208416833671,98.503006012024045,98.901803607214433,99.300601202404806,99.699398797595194,100.09819639278557,100.49699398797596,100.89579158316633,101.29458917835672,101.69338677354709,102.09218436873748,102.49098196392787,102.88977955911824,103.28857715430863,103.687374749499,104.08617234468939,104.48496993987976,104.88376753507015,105.28256513026052,105.68136272545091,106.08016032064128,106.47895791583167,106.87775551102204,107.27655310621243,107.67535070140281,108.07414829659319,108.47294589178357,108.87174348697395,109.27054108216433,109.66933867735472,110.06813627254509,110.46693386773548,110.86573146292585,111.26452905811624,111.66332665330661,112.062124248497,112.46092184368737,112.85971943887776,113.25851703406813,113.65731462925852,114.0561122244489,114.45490981963928,114.85370741482966,115.25250501002004,115.65130260521042,116.05010020040081,116.44889779559118,116.84769539078157,117.24649298597194,117.64529058116233,118.0440881763527,118.44288577154309,118.84168336673346,119.24048096192385,119.63927855711424,120.03807615230461,120.436873747495,120.83567134268537,121.23446893787576,121.63326653306613,122.03206412825652,122.4308617234469,122.82965931863728,123.22845691382766,123.62725450901804,124.02605210420842,124.42484969939881,124.82364729458918,125.22244488977957,125.62124248496994,126.02004008016033,126.4188376753507,126.81763527054109,127.21643286573146,127.61523046092185,128.01402805611224,128.4128256513026,128.81162324649299,129.21042084168337,129.60921843687376,130.00801603206412,130.40681362725451,130.8056112224449,131.20440881763528,131.60320641282564,132.00200400801603,132.40080160320642,132.79959919839681,133.19839679358716,133.59719438877755,133.99599198396794,134.39478957915833,134.79358717434869,135.19238476953907,135.59118236472946,135.98997995991985,136.38877755511024,136.7875751503006,137.18637274549098,137.58517034068137,137.98396793587176,138.38276553106212,138.78156312625251,139.1803607214429,139.57915831663328,139.97795591182364,140.37675350701403,140.77555110220442,141.17434869739481,141.57314629258516,141.97194388777555,142.37074148296594,142.76953907815633,143.16833667334669,143.56713426853707,143.96593186372746,144.36472945891785,144.76352705410821,145.1623246492986,145.56112224448898,145.95991983967937,146.35871743486973,146.75751503006012,147.15631262525051,147.55511022044089,147.95390781563125,148.35270541082164,148.75150300601203,149.15030060120242,149.54909819639278,149.94789579158316,150.34669338677355,150.74549098196394,151.1442885771543,151.54308617234469,151.94188376753507,152.34068136272546,152.73947895791582,153.13827655310621,153.5370741482966,153.93587174348698,154.33466933867737,154.73346693386773,155.13226452905812,155.53106212424851,155.92985971943889,156.32865731462925,156.72745490981964,157.12625250501003,157.52505010020042,157.92384769539078,158.32264529058116,158.72144288577155,159.12024048096194,159.5190380761523,159.91783567134269,160.31663326653307,160.71543086172346,161.11422845691382,161.51302605210421,161.9118236472946,162.31062124248498,162.70941883767534,163.10821643286573,163.50701402805612,163.90581162324651,164.30460921843687,164.70340681362725,165.10220440881764,165.50100200400803,165.89979959919839,166.29859719438878,166.69739478957916,167.09619238476955,167.49498997995991,167.8937875751503,168.29258517034069,168.69138276553107,169.09018036072143,169.48897795591182,169.88777555110221,170.2865731462926,170.68537074148298,171.08416833667334,171.48296593186373,171.88176352705412,172.28056112224451,172.67935871743487,173.07815631262525,173.47695390781564,173.87575150300603,174.27454909819639,174.67334669338678,175.07214428857716,175.47094188376755,175.86973947895791,176.2685370741483,176.66733466933869,177.06613226452907,177.46492985971943,177.86372745490982,178.26252505010021,178.6613226452906,179.06012024048096,179.45891783567134,179.85771543086173,180.25651302605212,180.65531062124248,181.05410821643287,181.45290581162325,181.85170340681364,182.250501002004,182.64929859719439,183.04809619238478,183.44689378757516,183.84569138276552,184.24448897795591,184.6432865731463,185.04208416833669,185.44088176352705,185.83967935871743,186.23847695390782,186.63727454909821,187.03607214428857,187.43486973947896,187.83366733466934,188.23246492985973,188.63126252505012,189.03006012024048,189.42885771543087,189.82765531062125,190.22645290581164,190.625250501002,191.02404809619239,191.42284569138278,191.82164328657316,192.22044088176352,192.61923847695391,193.0180360721443,193.41683366733469,193.81563126252505,194.21442885771543,194.61322645290582,195.01202404809621,195.41082164328657,195.80961923847696,196.20841683366734,196.60721442885773,197.00601202404809,197.40480961923848,197.80360721442887,198.20240480961925,198.60120240480961,199],"y":[0.004725334505631314,0.0047969011706719151,0.0048695464320200601,0.0049432863836056115,0.0050181373545615578,0.0050941159125103665,0.0051712388668915775,0.0052495232723310473,0.005328986432052151,0.0054096459013293699,0.0054915194909845944,0.0055746252709265118,0.0056589815737334327,0.0057446069982799181,0.0058315204134075545,0.005919740961640229,0.0060092880629442425,0.0061001814185335998,0.0061924410147208477,0.0062860871268136968,0.006381140323057889,0.0064776214686265059,0.0065755517296561114,0.0066749525773299881,0.0067758457920088057,0.0068782534674089735,0.0069821980148290098,0.0070877021674241817,0.0071947889845296155,0.0073034818560323402,0.0074138045067922431,0.0075257810011123919,0.0076394357472588581,0.0077547935020302796,0.0078718793753773646,0.0079907188350725449,0.008111337711429939,0.0082337622020758235,0.0083580188767697697,0.0084841346822764774,0.0086121369472886861,0.0087420533874009321,0.0088739121101345554,0.0090077416200138247,0.0091435708236933429,0.0092814290351367294,0.0094213459808466116,0.0095633518051459216,0.0097074770755104581,0.0098537527879527399,0.010002210372456936,0.010152881698464953,0.010305799080413437,0.01046099528332162,0.010618503528429779,0.010778357498888178,0.01094059134549619,0.011105239692491447,0.011272337643388596,0.011441920786867447,0.011614025202710179,0.011788687467787036,0.011965944662090342,0.012145834374816181,0.012328394710493342,0.012513664295158947,0.012701682282580201,0.012892488360521651,0.013086122757057244,0.013282626246926601,0.01348204015793446,0.013684406377392965,0.013889767358605389,0.014098166127390828,0.014309646288648685,0.014524252032961973,0.014742028143238418,0.014963020001388147,0.015187273595036873,0.015414835524273224,0.015645753008429089,0.015880073892891193,0.016117846655943159,0.016359120415635722,0.016603944936684142,0.016852370637390895,0.017104448596591906,0.017360230560624561,0.017619768950315636,0.017883116867987121,0.018150328104477854,0.018421457146178974,0.018696559182080744,0.018975690110828655,0.019258906547786166,0.019546265832101777,0.01983782603377773,0.020133645960737585,0.020433785165889961,0.020738303954185459,0.021047263389663808,0.021360725302487938,0.021678752295961966,0.02200140775352958,0.022328755845749251,0.022660861537242945,0.022997790593614308,0.023339609588332658,0.023686385909578674,0.024038187767047772,0.024395084198706809,0.024757145077499727,0.025124441117997699,0.025497043882988991,0.025875025790003656,0.026258460117768244,0.026647421012585302,0.027041983494632261,0.027442223464174433,0.027848217707686446,0.028260043903876219,0.028677780629605687,0.029101507365702009,0.029531304502653132,0.029967253346180937,0.030409436122685724,0.030857935984554736,0.031312837015328075,0.03177422423471455,0.032242183603450145,0.032716802027991515,0.033198167365036557,0.033686368425864296,0.034181494980485699,0.034683637761596955,0.035192888468326793,0.035709339769768859,0.036233085308290218,0.036764219702606502,0.037302838550614496,0.037849038431972314,0.038402916910417299,0.038964572535811495,0.039534104845904257,0.040111614367801578,0.040697202619131172,0.041290972108892404,0.041893026337979596,0.042503469799367477,0.043122407977946836,0.043749947349998576,0.044386195382293867,0.045031260530808068,0.045685252239035773,0.046348280935894132,0.04702045803320113,0.047701895922716037,0.048392707972727836,0.049093008524178382,0.049802912886306103,0.050522537331796,0.051251999091421613,0.051991416348164524,0.05274090823079601,0.053500594806906797,0.054270597075368437,0.055051036958212257,0.055842037291908911,0.056643721818034252,0.057456215173304168,0.05827964287896327,0.059114131329510725,0.059959807780746978,0.060816800337124749,0.061685237938387587,0.06256525034547962,0.063456968125708516,0.064360522637146422,0.065276046012249733,0.066203671140682485,0.067143531651324459,0.068095761893448375,0.06906049691704734,0.070037872452296618,0.071028024888131355,0.072031091249923962,0.073047209176242855,0.074076516894676717,0.075119153196705812,0.076175257411604663,0.077244969379357986,0.078328429422574591,0.079425778317381221,0.080537157263281201,0.081662707851961114,0.08280257203502997,0.083956892090674584,0.085125810589217352,0.086309470357559384,0.08750801444249641,0.088721586072891601,0.08995032862069291,0.0911943855607803,0.092453900429631031,0.093729016782790081,0.095019878151134565,0.096326627995919553,0.097649409662597289,0.098988366333396985,0.10034364097865868,0.10171537630691062,0.10310371471368453,0.10450879822906033,0.10593076846393543,0.10736976655501347,0.10882593310850823,0.1102994081425599,0.11179033102836199,0.1132988404299978,0.11482507424298632,0.11636916953154069,0.11793126246453964,0.1195114882502179,0.12110998106957989,0.12272687400854408,0.12436229898882548,0.1260163866975664,0.12768926651572671,0.1293810664452463,0.13109191303499323,0.13282193130551539,0.13457124467261139,0.13633997486974192,0.13812824186930101,0.1399361638027726,0.14176385687979487,0.14361143530616172,0.14547901120078754,0.14736669451166964,0.14927459293087736,0.15120281180860617,0.15315145406633174,0.15512062010910449,0.15711040773702462,0.15912091205594348,0.16115222538743415,0.16320443717808242,0.16527763390814518,0.16737189899963259,0.16948731272386508,0.17162395210856529,0.17378189084454307,0.17596119919203568,0.17816194388676659,0.1803841880457914,0.18262799107319647,0.18489340856572434,0.18718049221839644,0.18948928973021109,0.19181984470999291,0.19417219658247314,0.1965463804946852,0.19894242722275662,0.20136036307918601,0.20380020982069172,0.20626198455672304,0.20874569965872602,0.21125136267025688,0.21377897621803962,0.21632853792406481,0.21890004031882759,0.22149347075580611,0.22410881132728133,0.22674603878160249,0.22940512444199865,0.23208603412704801,0.23478872807290319,0.23751316085738589,0.24025928132605459,0.24302703252035521,0.24581635160796209,0.24862716981541869,0.25145941236318642,0.25431299840321125,0.25718784095911262,0.26008384686911079,0.26300091673178999,0.26593894485481184,0.26889781920668149,0.27187742137167076,0.27487762650800335,0.27789830330940252,0.28093931397010008,0.28400051415341004,0.28708175296395516,0.29018287292364686,0.29330370995150667,0.29644409334741811,0.29960384577989468,0.30278278327794711,0.3059807152271285,0.30919744436983282,0.31243276680992027,0.31568647202173555,0.31895834286358576,0.32224815559573339,0.32555567990296691,0.32888067892179118,0.33222290927229026,0.33558212109470048,0.33895805809073032,0.34235045756965737,0.34575905049922817,0.34918356156137892,0.35262370921279412,0.35607920575030505,0.35954975738113909,0.36303506429800625,0.36653482075902005,0.37004871517243265,0.37357643018616288,0.37711764278208759,0.38067202437506187,0.38423924091662542,0.38781895300334646,0.39141081598974886,0.39501448010576301,0.39862959057863023,0.40225578775918602,0.40589270725244558,0.40953998005240078,0.41319723268093905,0.41686408733077962,0.42054016201233002,0.42422507070434312,0.42791842350826381,0.43161982680613881,0.43532888342196407,0.43904519278633297,0.44276835110425206,0.44649795152597227,0.45023358432069416,0.45397483705299119,0.45772129476179202,0.46147254014176414,0.46522815372692639,0.46898771407633033,0.47275079796162855,0.47651698055636194,0.48028583562678007,0.4840569357240212,0.4878298523774614,0.49160415628905441,0.49537941752846848,0.49915520572883731,0.50293109028293315,0.50670664053957426,0.51048142600007151,0.51425501651453098,0.51802698247781687,0.52179689502498749,0.52556432622601335,0.52932884927959323,0.53309003870588034,0.5368474705379338,0.54060072251171309,0.54434937425443897,0.5480930074711392,0.55183120612920933,0.55556355664081325,0.55928964804296089,0.56300907217509544,0.56672142385403557,0.57042630104611003,0.57412330503634124,0.57781204059452818,0.58149211613808782,0.58516314389151936,0.58882474004235963,0.59247652489350799,0.59611812301179645,0.59974916337269302,0.60336927950103136,0.60697810960766385,0.61057529672194344,0.61416048881994079,0.61773333894831928,0.62129350534378647,0.62484065154805313,0.62837444651823615,0.63189456473264616,0.63540068629190871,0.63889249701537842,0.64236968853280152,0.64583195837119878,0.64927901003694266,0.65271055309300896,0.65612630323139287,0.65952598234067472,0.66290931856874746,0.66627604638069793,0.66962590661186394,0.67295864651607606,0.67627401980911239,0.67957178670739038,0.68285171396193489,0.68611357488765146,0.68935714938795989,0.69258222397482738,0.69578859178426167,0.69897605258731532,0.70214441279666917,0.70529348546885851,0.70842309030221251,0.7115330536305805,0.71462320841292504,0.71769339421885969,0.72074345721021971,0.7237732501187476,0.72678263221999007,0.72977146930349313,0.73273963363939454,0.73568700394150777,0.7386134653269999,0.74151890927276043,0.7444032335685693,0.74726634226716127,0.75010814563129724,0.75292856007794695,0.75572750811968958,0.75850491830344136,0.76126072514661636,0.76399486907083214,0.76670729633326573,0.76939795895577212,0.7720668146518691,0.77471382675170242,0.7773389641250934,0.77994220110278256,0.78252351739596826,0.78508289801425135,0.78762033318208946,0.79013581825386325,0.79262935362765619,0.79510094465785108,0.7975506015666417,0.79997833935455698,0.80238417771009363,0.80476814091855409,0.80713025777017999,0.80947056146767493,0.81178908953320117,0.81408588371494295,0.8163609898933174,0.81861445798691779,0.82084634185826855,0.82305669921947289,0.82524559153782717,0.82741308394147917,0.82955924512519807,0.83168414725633044,0.83378786588100573,0.83587047983066065,0.83793207112893975,0.83997272489903818,0.84199252927154167,0.84399157529282076,0.84596995683403187,0.84792777050077772,0.84986511554347643,0.85178209376848435,0.85367880945001917,0.85555536924292319,0.85741188209631169,0.85924845916813797,0.86106521374071665,0.86286226113723541,0.8646397186392899,0.86639770540546746,0.86813634239101356,0.86985575226860024,0.8715560593502244,0.87323738951025798,0.87489987010966896,0.8765436299214312,0.87816879905714273,0.87977550889486378,0.88136389200819287,0.88293408209658542,0.88448621391693449,0.8860204232164145,0.88753684666659971,0.8890356217988622,0.89051688694105369,0.89198078115547508,0.89342744417813591,0.89485701635930326,0.89626963860534137,0.89766545232183947,0.89904459935802683],"mode":"lines","name":"Probability Curve","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Predicted Probability of Diabetes by Glucose Levels
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-a-simple-model" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-simple-model">Creating a simple model</h2>
<p>Here is the code to create and summarize a logistic regression model with this data (followed by results).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> glucose,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> PimaIndiansDiabetes,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> binomial)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes ~ glucose, family = binomial, data = PimaIndiansDiabetes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -5.350080   0.420827  -12.71   &lt;2e-16 ***
glucose      0.037873   0.003252   11.65   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 993.48  on 767  degrees of freedom
Residual deviance: 808.72  on 766  degrees of freedom
AIC: 812.72

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<section id="explanatory-notes" class="level3">
<h3 class="anchored" data-anchor-id="explanatory-notes">Explanatory Notes</h3>
<ul>
<li><p>glm() is used to fit a generalized linear model</p></li>
<li><p>The formula diabetes ~ glucose specifies that we are modelling diabetes as the outcome, predicted by glucose</p></li>
<li><p>The family = binomial argument indicates that we are using logistic regression (appropriate for binary outcomes</p></li>
<li><p>summary(model) provides detailed results of the model</p></li>
</ul>
<p>Intercept tells us what the model looks like when glucose is zero (where the model intercepts the y-axis). This is meaningless in this example because people can’t live with zero glucose. So we can ignore that number.</p>
<p>We have coefficients for glucose, and our predictor variable. This will tell us what happens when the value of glucose changes. Specifically how it affects a person being diagnosed with diabetes. The change can be positive, negative, or zero. A positive number means that as glucose levels go up, the chances of being diagnosed with diabetes goes up too. If it were zero, there would be no change. If it were negative, it would mean that as glucose goes up, the chances of being diagnosed with diabetes would go down.</p>
<p>We use the term “chances” and not “probability” because the actual number is what is referred to as “long-odds” or the logarithm of the odds ratio.</p>
</section>
</section>
<section id="a-single-categorical-predictor" class="level2">
<h2 class="anchored" data-anchor-id="a-single-categorical-predictor">A Single Categorical Predictor</h2>
<p>Now let’s consider the same question using a categorical variable as predictor. The dataset doesn’t have a categorical variable using the age variable - dividing observations into “Young adult”, “Middle aged”, “Older adult”. We’re doing this to illustrate how to interpret the logistic regression results. In reality, it would be best practice to leave the Age variable as numeric and include it in the model.</p>
<p>Here is the code to create a categorical variable from a numeric variable:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>age_data <span class="ot">&lt;-</span> PimaIndiansDiabetes <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Young adult"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"Middle aged"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Older adult"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Young adult"</span>, <span class="st">"Middle aged"</span>, <span class="st">"Older adult"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group, diabetes) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the chart</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_data, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> proportion, <span class="at">fill =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"neg"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"pos"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"neg"</span> <span class="ot">=</span> <span class="st">"No diabetes"</span>, <span class="st">"pos"</span> <span class="ot">=</span> <span class="st">"Diabetes"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion (%)"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Diabetes Status"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Diabetes Proportions by Age Group"</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-age-proportion" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-age-proportion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="22-Logistic-Regression_files/figure-html/fig-age-proportion-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-proportion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Diabetes Proportion by Age Group
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-age-proportion" class="quarto-xref">Figure&nbsp;3</a> shows the proportion of observations that have a diagnosis of diabetes changes across these three categories.</p>
<p>Now let’s create a logistic regression model using age group (a categorical variable) as the predictor</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>age_data2 <span class="ot">&lt;-</span> PimaIndiansDiabetes <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Young adult"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"Middle aged"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Older adult"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Young adult"</span>, <span class="st">"Middle aged"</span>, <span class="st">"Older adult"</span>)))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> age_group,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> age_data2,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> binomial)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes ~ age_group, family = binomial, data = age_data2)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -1.3122     0.1229 -10.675  &lt; 2e-16 ***
age_groupMiddle aged   1.3191     0.1699   7.765 8.16e-15 ***
age_groupOlder adult   1.1886     0.2543   4.673 2.96e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 993.48  on 767  degrees of freedom
Residual deviance: 924.66  on 765  degrees of freedom
AIC: 930.66

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Under the heading “Coefficients” you’ll notice there is no row for “Young adult”. This is because it is our reference category. This is how R handles <strong>categorical variables</strong> in regression models. When you include a factor like <code>age_group</code>, R uses what’s called <strong>dummy coding</strong> (or <em>treatment coding</em>). It picks one of the factor levels to be the <strong>reference category</strong>, and all the other levels are compared to it. “<strong>Young adult</strong>” is the <strong>baseline</strong> or reference group. The regression intercept represents the log-odds of diabetes for this group, and the coefficients for “Middle aged” and “Older adult” tell you how much <em>more</em> (or less) likely those groups are to have diabetes compared to “Young adult.”</p>
</section>
<section id="adding-variables" class="level2">
<h2 class="anchored" data-anchor-id="adding-variables">Adding Variables</h2>
<p>By considering multiple predictors simultaneously, logistic regression allows us to exploit how each variable contributes to the likelihood of the outcome (in this case, diabetes) while accounting for the influence of others.</p>
<p>In the case of risk of diabetes, there may be multiple risk factors that we want to consider. Let’s start by adding variables to our model and see what happens. We’ll start by adding age to the model (the original age, numeric variable, not the categorical variable we created.</p>
<p>One of the key strengths of logistic regression is the ability to include multiple predictor variables in the model. For example, beyond plasma glucose concentration, we can include variables such as age, weight, pregnancy history, and blood pressure for example.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Two predictors</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> glucose <span class="sc">+</span> age,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> PimaIndiansDiabetes,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> binomial)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes ~ glucose + age, family = binomial, data = PimaIndiansDiabetes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -5.912449   0.462620  -12.78  &lt; 2e-16 ***
glucose      0.035644   0.003290   10.83  &lt; 2e-16 ***
age          0.024778   0.007374    3.36 0.000778 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 993.48  on 767  degrees of freedom
Residual deviance: 797.36  on 765  degrees of freedom
AIC: 803.36

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><strong>Glucose</strong>:</p>
<p>Looking at the results, we can see that glucose remains a positive and statistically significant predictor of diabetes. The coefficient is slightly lower than in the model without age. This reflects the adjusted effect of glucose on the likelihood of being diagnosed with diabetes, accounting for the effect of age. In other words, some of the previously observed effect of glucose on diabetes risk can now be attributed to the different ages of the subjects rather than solely on their glucose levels.</p>
<p><strong>Age</strong>:</p>
<p>Age also has a positive effect on the likelihood of being diagnosed with diabetes, and the small p-value confirms this effect is statistically significant. Because glucose is included in the model, the age effect is adjusted for glucose.</p>
<p>Explanatory notes on other results:</p>
<ol type="1">
<li><strong>Akaike Information Criteria (AIC)</strong>:
<ul>
<li>A metric for comparing models, balancing goodness of fit with model complexity</li>
<li>Lower AIC values suggest better trade-off between fit and complexity. Adding variables that improve the model without overfitting typical results in a lower AIC.</li>
<li>The AIC (803.36) is also lower than the glucose-only model (814.59) indicating that adding age improves the model’s overall fit.</li>
</ul></li>
<li><strong>Residual Deviance</strong>:
<ul>
<li>Measures how well the model fits the data. It is a measure of the discrepancies between observed outcomes and the model’s predictions.</li>
<li>Lower values indicate better fit. A drop in residual deviance when adding a variable suggests the new variable improves the model.</li>
<li>The residual deviance (797.36) is lower than that of the glucose-only model (808.59), showing improved fit with the addition of age.</li>
</ul></li>
<li><strong>Null Deviance</strong>:
<ul>
<li>Represents the deviance of a model with no predictors (only an intercept)</li>
<li>This is the baseline for comparison, showing how much better the model predictors perform compared to a model with no predictors.</li>
<li>When to use: Null deviance is useful in understanding the baseline dataset. For instance, if the null deviance is very high and the residual deviance of your model remains close to it, it indicates that your predictors are not significantly improving the model’s fit, and the model may not be capturing meaningful relationships in the data.</li>
</ul></li>
<li><strong>Number of Fisher Score Iterations:</strong>
<ul>
<li>Refers to the number of iterations the algorithm needed to converge on a solution when estimating model parameters.</li>
<li>Fewer iterations indicates faster convergence, but this metric is not typically used to evaluate model quality.</li>
<li>When to use: If a model takes an unusually high number of iterations to converge, it might signal an issue with the data or the model, such as multicollinearity or poorly scaled variables. Hypothetical example: If a logistic regression model takes 50 iterations (instead of 4-5) to converge, you might check for these issues or simplify the model.</li>
</ul></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We now have the tools we need to build a model. We can add numeric and categorical variables and look at the p-value of the coefficients to determine if its predictive value is statistically significant and then look at the residual deviance and AIC, which if lower, indicate the model is improved by adding that variable.</p>
</div>
</div>
</div>
<p>Before building the model however, there are a few concepts and ideas that we need to explore that will help us understand how variables interact with each other.</p>
</section>
<section id="confounding-variables" class="level2">
<h2 class="anchored" data-anchor-id="confounding-variables">Confounding Variables</h2>
<p>Confounding occurs when a third variable influences both the predictor and the outcome, distorting the relationship between the predictor and the outcome.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Confounding creates a spurious association that might disappear or change when the confounding variable is controlled for by including it in the model.</p>
</div>
</div>
</div>
<p>In this mode, for example, we should ask if being older (age) has an effect on the likelihood of diabetes (the outcome variable) AND glucose levels. If that were true, then some of the effect of glucose on diabetes could be accounted for simply by virtue of the fact that older people have higher glucose levels AND older people are more likely to have diabetes.</p>
<p><a href="#fig-smooth-plot" class="quarto-xref">Figure&nbsp;4</a> shows the relationship between age and glucose levels in the dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>PimaIndiansDiabetes <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(age, glucose)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-smooth-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-smooth-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="22-Logistic-Regression_files/figure-html/fig-smooth-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smooth-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Glucose Levels vs Age
</figcaption>
</figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Basic Summary Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Custom Title and Theme</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Adding a Bar Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">

</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">

</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">

</div>
</div>
</div>
</section>
<section id="effect-modifiers" class="level2">
<h2 class="anchored" data-anchor-id="effect-modifiers">Effect Modifiers</h2>
</section>
<section id="collinearity" class="level2">
<h2 class="anchored" data-anchor-id="collinearity">Collinearity</h2>
</section>
<section id="building-the-model" class="level2">
<h2 class="anchored" data-anchor-id="building-the-model">Building the Model</h2>
</section>
<section id="checking-model-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="checking-model-assumptions">Checking Model Assumptions</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>